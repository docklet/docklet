#!/bin/bash

. /etc/docklet/docklet.conf

HOME_PREF=${NFS_PREFIX}/global

mkdir -p ${HOME_PREF}/images

[[ "`whoami`" != "root" ]] && echo "Root previledge required!" && exit 1


if [[ "$1" == "drop_2v" ]]; then
	if [[ -e ${HOME_PREF}/images/pub_$2 ]] || [[ -e ${HOME_PREF}/images/self_$2 ]]; then
		rm -rf ${HOME_PREF}/images/pub_$2 ${HOME_PREF}/images/self_$2
	else
		false
	fi
elif [[ "$1" == "switch_2v" ]]; then
	[[ "$2" == "" ]] && exit 1
	[[ -e ${HOME_PREF}/images/pub_$2 ]] && MOD=pub && NEW_MOD=self
	[[ -e ${HOME_PREF}/images/self_$2 ]] && MOD=self && NEW_MOD=pub
	[[ "${MOD}" == "" ]] && exit 1
	OWN="`echo $2 | awk -F\_ '{ print $1 }'`"
	IMG="`echo $2 | awk -F\_ '{ print $2 }'`"
	mv ${HOME_PREF}/images/${MOD}_${OWN}_${IMG} ${HOME_PREF}/images/${NEW_MOD}_${OWN}_${IMG}
fi

